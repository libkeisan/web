var a=class{constructor(){this.raw=keisan.load("rates.json"),this.raw||this.fetch(),this.data=JSON.parse(this.raw),this.data.time_next_update_unix<Date.now()/1e3&&this.fetch()}fetch(){keisan.log("Fetching currency data");let t=keisan.get("https://open.er-api.com/v6/latest/USD");if(!t||t.status!==200)throw new Error("Failed to fetch currency data");this.raw=t.body,this.data=JSON.parse(this.raw),keisan.save("rates.json",this.raw)}get(t){let e=this.data?.rates||{};return parseFloat(e[t])||0}},c={rules:["NUMBER IDENT[3] (K_TO | K_AS | K_IN) IDENT[3] -> currency"],action:(i,t)=>{let e=new a,s=e.get(t[1].value),r=e.get(t[3].value);if(!s||!r)return null;let n=t[0].value;return n.value*=r/s,[{type:"NUMBER",value:n},{type:"IDENT",value:t[3].value}]}};export{c as default};
